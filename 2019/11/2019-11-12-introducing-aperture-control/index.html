<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Introducing Aperture Control - Janne "Lietu" Enberg</title><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content="@lietux"><meta name=twitter:title content><meta name=twitter:description content><meta name=Description content="New tool for automating Windows environments"><meta property="og:title" content="Introducing Aperture Control"><meta property="og:description" content="New tool for automating Windows environments"><meta property="og:type" content="article"><meta property="og:url" content="https://lietu.net/2019/11/2019-11-12-introducing-aperture-control/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-11-12T00:00:00+00:00"><meta property="article:modified_time" content="2019-11-12T00:00:00+00:00"><meta name=application-name content="Janne &#34;Lietu&#34; Enberg"><meta name=apple-mobile-web-app-title content="Janne &#34;Lietu&#34; Enberg"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=192x192 href=/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=/android-chrome-512x512.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://lietu.net/2019/11/2019-11-12-introducing-aperture-control/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/lib/prismjs/prism.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Introducing Aperture Control","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/lietu.net\/2019\/11\/2019-11-12-introducing-aperture-control\/"},"genre":"post","keywords":"productivity, windows, tutorial, opensource","wordCount":909,"url":"https:\/\/lietu.net\/2019\/11\/2019-11-12-introducing-aperture-control\/","datePublished":"2019-11-12T00:00:00+00:00","dateModified":"2019-11-12T00:00:00+00:00","description":"New tool for automating Windows environments"}</script></head><body data-header-desktop data-header-mobile><script>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header><div class="desktop header" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title='Janne "Lietu" Enberg' class="header-logo logo-svg">Janne "Lietu" Enberg</a></div><div class=menu><nav><h2 class=display-hidden>Основная навигация</h2><ul class=menu-inner><li><a class=menu-item href=/post/>Posts</a></li></ul></nav><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><span class="svg-icon icon-moon"></span></a></div></div></div><div class="mobile header" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title='Janne "Lietu" Enberg' class=header-logo>Janne "Lietu" Enberg</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><nav><h2 class=display-hidden>Основная навигация</h2><ul><li><a class=menu-item href=/post/ title>Posts</a></li></ul></nav><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><span class="svg-icon icon-moon"></span></a></div></div></div></header><main class=main><div class=container><div class="page single special"><h1 class="single-title pulse faster">Introducing Aperture Control</h1><div class=content id=content><p>I previously posted about how to &ldquo;<a href=https://lietu.net/2019/07/2019-07-11-developing-like-a-pro-on-windows/ rel>develop like a pro on Windows</a>&rdquo; as it seemed to me like most people really failed to understand that a lot of great tools exist for Windows that make developers very effective also on Windows.</p><p>Since then I&rsquo;ve bumped into concepts like <a href=https://nixos.org/nix/ target=_blank rel="noopener noreffer">Nix, a purely functional package manager</a> and have been wondering if we could reach some similar goals with Windows.</p><p>The things I wanted to see synchronized between all my Windows machines, and automated after a new installation were at least:</p><ul><li>Installed applications</li><li>Configuration for common things like Git</li><li>Environment variables, file associations, and the like</li><li>Windows features (e.g. Hyper-V, and Windows Subsystem for Linux)</li><li>Other Windows settings (Dark Mode, sleep and hibernation, privacy related settings, etc.)</li></ul><p>I looked around for existing tooling and &mldr; well it didn&rsquo;t look like there was much around that didn&rsquo;t have a number of dependencies I&rsquo;d have to install first, that were free, didn&rsquo;t require running servers, and wouldn&rsquo;t relinquish control of your PC to some external system.</p><h1 id=introducing-aperture-control class=headerLink><a href=#introducing-aperture-control class=header-mark></a>Introducing Aperture Control</h1><p>After some thinking I realized the problem shouldn&rsquo;t be all that difficult to solve at least partially and get into a significantly meaningful level of support with some PowerShell scripts, Batch scripts, and Registry patches.</p><p>I&rsquo;d already seen a number of installers with a quick PowerShell one-liner, so I thought that might be the way I&rsquo;d want to go and gave it a go.</p><p>And so now we have <a href=https://github.com/Lieturd/aperture-control target=_blank rel="noopener noreffer">Aperture Control</a> and an accompanying &ldquo;<a href=https://github.com/Lieturd/aperture-control-recipes target=_blank rel="noopener noreffer">recipe collection</a>&rdquo; with some of the first attempts to solve my most common headaches.</p><p><img loading=lazy decoding=async class=render-image src=https://thepracticaldev.s3.amazonaws.com/i/97nopw2zkyatcag75q3u.gif alt="Aperture Control in action" title=97nopw2zkyatcag75q3u.gif></p><h2 id=how-to-use-aperture-control class=headerLink><a href=#how-to-use-aperture-control class=header-mark></a>How to use Aperture Control</h2><p>First step is to fork the <a href=https://github.com/Lieturd/aperture-control target=_blank rel="noopener noreffer">Aperture Control repository in GitHub</a> and customize it according to your needs.</p><p>Let&rsquo;s take the example that you would like to install <a href=https://chocolatey.org target=_blank rel="noopener noreffer">Chocolatey</a>, and a number of packages with it.</p><p>Step 1: Get the <a href=https://github.com/Lieturd/aperture-control-recipes/blob/master/recipes/install-chocolatey.ps1 target=_blank rel="noopener noreffer">recipe to install or upgrade Chocolatey</a> and copy it in your repository as <code>recipes/01-install-chocolatey.ps1</code>.</p><p>Step 2: Get the <a href=https://github.com/Lieturd/aperture-control-recipes/blob/master/recipes/install-packages.ps1 target=_blank rel="noopener noreffer">recipe to install packages</a> and copy it in your repository as <code>recipes/02-install-packages.ps1</code>.</p><p>Step 3: Customize according to your desires, e.g. if you wanted to install 7-Zip, ConEmu, Visual Studio Code, and Windows Subsystem for Linux you would customize the script to say something like:</p><div class=highlight><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># Install all the packages you want to use in other scripts</span>

<span class=n>choco</span><span class=p>.</span><span class=n>exe</span> <span class=n>install</span> <span class=n>-y</span> <span class=p>`</span>
    <span class=n>7zip</span> <span class=p>`</span>
    <span class=n>conemu</span> <span class=p>`</span>
    <span class=n>vscode</span> <span class=p>`</span>
    <span class=n>wsl</span> <span class=p>`</span>
    <span class=c># This non-empty line is important, do not move it</span>
</code></pre></div><p>You can find the names of Chocolatey packages with the <code>choco search</code> command, or via their <a href=https://chocolatey.org/packages target=_blank rel="noopener noreffer">online package search</a>. The collection is really quite impressive (and there&rsquo;s Scoop as well with a few unique additions).</p><p>Step 4: Commit and push your changes to your fork.</p><p>Step 5: Run Aperture Control in an Administrator PowerShell (replace <code>your/repository</code> with the correct GitHub user and repository):</p><div class=highlight><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># Windows by default seems to block execution of PowerShell scripts</span>
<span class=nb>Set-ExecutionPolicy</span> <span class=n>-ExecutionPolicy</span> <span class=n>Unrestricted</span>

<span class=p>(</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>WebClient</span><span class=p>).</span><span class=n>DownloadFile</span><span class=p>(</span><span class=s1>&#39;https://raw.githubusercontent.com/your/repository/master/setup.ps1&#39;</span><span class=p>,</span> <span class=s1>&#39;setup.ps1&#39;</span><span class=p>)</span>
<span class=p>.\</span><span class=n>setup</span><span class=p>.</span><span class=n>ps1</span> <span class=n>your</span><span class=p>/</span><span class=n>repository</span>
</code></pre></div><p>If you really want, you can also store the repository contents on e.g. an USB stick and not share the scripts on GitHub. You only need to run the <code>run-ac-recipes.ps1</code> -script as Administrator then, as <code>setup.ps1</code> takes care of downloading the GitHub repository contents.</p><h2 id=the-standard-development-environment class=headerLink><a href=#the-standard-development-environment class=header-mark></a>The &ldquo;standard development environment&rdquo;</h2><p>After writing a few recipes for my own use and thinking about what kind of tips I would like to share with my friends, I thought of the concept of a &ldquo;standard development environment&rdquo;, what I would consider things that everyone should be doing.</p><p>Similar to how in Linux world it&rsquo;s now common to have <code>~/.bin</code> in your <code>PATH</code> for all those little binaries you end up with, there should be a <code>%USERPROFILE%\bin</code> on Windows. You will want certain tools installed, better terminal, ability to configure aliases, and so on.</p><p>So with that in mind, I built <a href=https://github.com/Lieturd/aperture-control-example target=_blank rel="noopener noreffer">an example for Aperture control</a> to configure what I would consider a fairly standard development environment. It&rsquo;s still fairly opinionated on what kind of tools and configuration people might want, but it&rsquo;s easy to fork and configure to your needs.</p><p>I&rsquo;d love to hear feedback on what kind of parts you might want to see there, what do you think is extraneous, and how it&rsquo;s working for you.</p><h2 id=whats-next class=headerLink><a href=#whats-next class=header-mark></a>What&rsquo;s next?</h2><p>There&rsquo;s a lot of things that Aperture Control still cannot do by itself, but overall PowerShell is quite capable and the <a href=https://www.powershellgallery.com target=_blank rel="noopener noreffer">PowerShell Gallery</a> has lots of extra things to provide even more capabilities for it, so there really are not a lot of limits for what you can do with this.</p><p>What should be considered is if it is easily possible to e.g. deal with backing up or syncing various application settings (IDEs, browsers, etc.), and how to better deal with keeping your own custom files in the repository (e.g. for <a href=https://dev.to/lietux/developing-like-a-pro-on-windows-4bbh#scripting target=_blank rel="noopener noreffer">Autorun cmd</a>) and easily apply them.</p><p>I don&rsquo;t have all the ideas for what problems should be solved, or how to solve them, but I imagine there&rsquo;s a lot of smart people out there who can contribute. <em>YOU</em> can help by testing it out, spreading the word, submitting feature requests and bug reports (both for the tool and the recipes), creating new recipes, and so on.</p><p>You can tell me in the comments, what would you like to see automated in your Windows environments?</p><p><em>Edit: Updated the tool a bit to have all the recipes stored in one folder for better control over the execution order of recipes of all types and updated the post.</em></p><p><em>Edit:</em> Added reference to &ldquo;standard development environment&rdquo;</p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://ublogger.netlify.app/?utm_source=https://lietu.net/&utm_medium=footer&utm_campaign=config&utm_term=2.0.1" target=_blank title="uBlogger 2.0.1">uBlogger</a></div><div class=footer-line><i class="svg-icon icon-copyright"></i><span>2021</span></div></div></footer></div><aside id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="svg-icon icon-arrow-up"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="svg-icon icon-comments-fixed"></i></a></aside><script src=/lib/smooth-scroll/smooth-scroll.min.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{}}</script><script src=/js/theme.min.js></script></body></html>