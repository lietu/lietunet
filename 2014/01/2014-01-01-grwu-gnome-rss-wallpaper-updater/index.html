<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>GRWU - Gnome RSS Wallpaper Updater - Janne "Lietu" Enberg</title><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content="@lietux"><meta name=twitter:title content><meta name=twitter:description content><meta name=Description content><meta property="og:title" content="GRWU - Gnome RSS Wallpaper Updater"><meta property="og:description" content="UPDATE: Project in GitHubBecause I wanted to make some updates to this tool, I found it more convenient to move the project to GitHub. Here's the link: https://github.com/lietu/grwu/
Further updates will happen there, and only there.
What is this?I was using the NASA image of the day RSS feed to dynamically update the wallpaper on my Windows desktops and realized I wasn't doing that on my linux desktops (which are running Gnome 3)."><meta property="og:type" content="article"><meta property="og:url" content="https://lietu.net/2014/01/2014-01-01-grwu-gnome-rss-wallpaper-updater/"><meta property="article:section" content="post"><meta property="article:published_time" content="2014-01-01T00:00:00+00:00"><meta property="article:modified_time" content="2014-01-01T00:00:00+00:00"><meta name=application-name content="Janne &#34;Lietu&#34; Enberg"><meta name=apple-mobile-web-app-title content="Janne &#34;Lietu&#34; Enberg"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=192x192 href=/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=/android-chrome-512x512.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://lietu.net/2014/01/2014-01-01-grwu-gnome-rss-wallpaper-updater/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/lib/prismjs/prism.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"GRWU - Gnome RSS Wallpaper Updater","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/lietu.net\/2014\/01\/2014-01-01-grwu-gnome-rss-wallpaper-updater\/"},"genre":"post","wordCount":1003,"url":"https:\/\/lietu.net\/2014\/01\/2014-01-01-grwu-gnome-rss-wallpaper-updater\/","datePublished":"2014-01-01T00:00:00+00:00","dateModified":"2014-01-01T00:00:00+00:00","description":""}</script></head><body data-header-desktop data-header-mobile><script>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header><div class="desktop header" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title='Janne "Lietu" Enberg' class="header-logo logo-svg">Janne "Lietu" Enberg</a></div><div class=menu><nav><h2 class=display-hidden>Основная навигация</h2><ul class=menu-inner><li><a class=menu-item href=/post/>Posts</a></li></ul></nav><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><span class="svg-icon icon-moon"></span></a></div></div></div><div class="mobile header" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title='Janne "Lietu" Enberg' class=header-logo>Janne "Lietu" Enberg</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><nav><h2 class=display-hidden>Основная навигация</h2><ul><li><a class=menu-item href=/post/ title>Posts</a></li></ul></nav><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><span class="svg-icon icon-moon"></span></a></div></div></div></header><main class=main><div class=container><div class="page single special"><h1 class="single-title pulse faster">GRWU - Gnome RSS Wallpaper Updater</h1><div class=content id=content><h4>UPDATE: Project in GitHub</h4><p>Because I wanted to make some updates to this tool, I found it more convenient to move the project to GitHub. Here's the link: <a href=https://github.com/lietu/grwu/>https://github.com/lietu/grwu/</a></p><p>Further updates will happen there, and only there.</p><h4>What is this?</h4><p>I was using the NASA image of the day RSS feed to dynamically update the wallpaper on my Windows desktops and realized I wasn't doing that on my linux desktops (which are running Gnome 3). I checked quickly and it looked like there were no existing tools for this, so I rolled my own.</p><h4>grwu.py</h4><p>Put the contents below to a file called "grwu.py" and place that file anywhere you want.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ch>#!/usr/bin/env python</span>
<span class=c1>#</span>
<span class=c1># GRWU - Gnome RSS Wallpaper Updater</span>
<span class=c1>#</span>
<span class=c1># Reads an RSS feed, picks an image out of it, downloads it and updates your</span>
<span class=c1># gnome background image with that image. It is very much possible that this</span>
<span class=c1># only works with the NASA image of the day feed format.</span>
<span class=c1>#</span>
<span class=c1># Recommend using with crontab (run &#34;crontab -e&#34; to edit it), add e.g.:</span>
<span class=c1>#</span>
<span class=c1># 30 * * * * export $(xargs -n 1 -0 echo &lt;/proc/$(pidof gnome-session)/environ | grep -Z DBUS_SESSION_BUS_ADDRESS=); python /path/to/grwu.py &#34;http://url.to/feed.rss&#34;</span>
<span class=c1>#</span>
<span class=c1>#</span>
<span class=c1># Distributed with the &#34;New BSD License&#34;:</span>
<span class=c1># ---------------------------------------</span>
<span class=c1>#</span>
<span class=c1># Copyright (c) 2014, Janne Enberg</span>
<span class=c1># All rights reserved.</span>
<span class=c1>#</span>
<span class=c1># Redistribution and use in source and binary forms, with or without</span>
<span class=c1># modification, are permitted provided that the following conditions are met:</span>
<span class=c1>#</span>
<span class=c1>#   * Redistributions of source code must retain the above copyright notice,</span>
<span class=c1>#     this list of conditions and the following disclaimer.</span>
<span class=c1>#   * Redistributions in binary form must reproduce the above copyright</span>
<span class=c1>#     notice, this list of conditions and the following disclaimer in the</span>
<span class=c1>#     documentation and/or other materials provided with the distribution.</span>
<span class=c1>#   * Neither the name of grwu nor the names of its contributors</span>
<span class=c1>#     may be used to endorse or promote products derived from this software</span>
<span class=c1>#     without specific prior written permission.</span>
<span class=c1>#</span>
<span class=c1># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &#34;AS IS&#34;</span>
<span class=c1># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class=c1># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class=c1># ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span>
<span class=c1># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class=c1># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class=c1># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class=c1># INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class=c1># CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class=c1># ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class=c1># POSSIBILITY OF SUCH DAMAGE.</span>
<span class=c1>#</span>

<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>sys</span>
<span class=kn>import</span> <span class=nn>zlib</span>
<span class=kn>import</span> <span class=nn>urllib2</span>
<span class=kn>import</span> <span class=nn>xml.etree.ElementTree</span> <span class=kn>as</span> <span class=nn>ET</span>
<span class=kn>from</span> <span class=nn>random</span> <span class=kn>import</span> <span class=n>choice</span>
<span class=kn>from</span> <span class=nn>tempfile</span> <span class=kn>import</span> <span class=n>NamedTemporaryFile</span>
<span class=kn>from</span> <span class=nn>subprocess</span> <span class=kn>import</span> <span class=n>call</span>


<span class=c1># Read this many bytes of HTTP responses per iteration</span>
<span class=n>READ_BLOCK_SIZE</span> <span class=o>=</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>8</span>

<span class=c1># Default RSS feed url</span>
<span class=n>rssUrl</span> <span class=o>=</span> <span class=s2>&#34;http://www.nasa.gov/rss/dyn/image_of_the_day.rss&#34;</span>

<span class=c1># Path to store wallpapers in</span>
<span class=n>tempPath</span> <span class=o>=</span> <span class=s1>&#39;/tmp/gnome-wallpaper-updater/&#39;</span>

<span class=c1># Set to True to NOT delete all old files after update</span>
<span class=n>keepFiles</span> <span class=o>=</span> <span class=bp>False</span>

<span class=c1># Shush, don&#39;t output anything</span>
<span class=n>quiet</span> <span class=o>=</span> <span class=bp>True</span>


<span class=k>class</span> <span class=nc>WallpaperUpdater</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>

    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>quiet</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>quiet</span> <span class=o>=</span> <span class=n>quiet</span>

    <span class=k>def</span> <span class=nf>log</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>message</span><span class=p>):</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>quiet</span><span class=p>:</span>
            <span class=k>print</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>,</span> <span class=n>keepFiles</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Update wallpaper from RSS feed&#34;&#34;&#34;</span>

        <span class=c1># Check that our path exists</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>storeDir</span><span class=p>):</span>
            <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>storeDir</span><span class=p>)</span>

        <span class=c1># Get the new wallpaper image</span>
        <span class=n>path</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_wallpaper</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>)</span>

        <span class=c1># Update it as the wallpaper</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_set_wallpaper</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>

        <span class=c1># Clean up if needed</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>keepFiles</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_clean_dir</span><span class=p>(</span><span class=n>storeDir</span><span class=p>,</span> <span class=p>[</span><span class=n>path</span><span class=p>])</span>

    <span class=k>def</span> <span class=nf>_get_wallpaper</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Download new wallpaper and return full path to file&#34;&#34;&#34;</span>

        <span class=n>uri</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_wallpaper_uri</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>)</span>
        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_uri</span><span class=p>(</span><span class=n>uri</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>)</span>

    <span class=k>def</span> <span class=nf>_get_wallpaper_uri</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Pick the wallpaper image to use from the RSS feed&#34;&#34;&#34;</span>

        <span class=k>return</span> <span class=n>choice</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_get_wallpaper_uris</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>))</span>

    <span class=k>def</span> <span class=nf>_get_wallpaper_uris</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Get a list of image URIs in the RSS feed&#34;&#34;&#34;</span>

        <span class=n>uris</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=n>root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_rss</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>enc</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>(</span><span class=s1>&#39;enclosure&#39;</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>enc</span><span class=o>.</span><span class=n>attrib</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;image/&#34;</span><span class=p>):</span>
                <span class=n>uris</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>enc</span><span class=o>.</span><span class=n>attrib</span><span class=p>[</span><span class=s2>&#34;url&#34;</span><span class=p>])</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=s2>&#34;Found {} images in feed&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>uris</span><span class=p>))))</span>

        <span class=k>return</span> <span class=n>uris</span>

    <span class=k>def</span> <span class=nf>_load_rss</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Load XML for the RSS, returns root node&#34;&#34;&#34;</span>

        <span class=n>filename</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_load_uri</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>)</span>
        <span class=n>root</span> <span class=o>=</span> <span class=n>ET</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span><span class=o>.</span><span class=n>getroot</span><span class=p>()</span>
        <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>root</span>

    <span class=k>def</span> <span class=nf>_load_uri</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>uri</span><span class=p>,</span> <span class=n>storeDir</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Load URI contents, handle gzip, save to file&#34;&#34;&#34;</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=s2>&#34;Loading &#34;</span> <span class=o>+</span> <span class=n>uri</span><span class=p>)</span>
        <span class=n>request</span> <span class=o>=</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>Request</span><span class=p>(</span><span class=n>uri</span><span class=p>)</span>
        <span class=n>request</span><span class=o>.</span><span class=n>add_header</span><span class=p>(</span><span class=s1>&#39;Accept-Encoding&#39;</span><span class=p>,</span> <span class=s1>&#39;gzip&#39;</span><span class=p>)</span>
        <span class=n>response</span> <span class=o>=</span> <span class=n>urllib2</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
        <span class=n>encoding</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;content-encoding&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>

        <span class=n>isGZipped</span> <span class=o>=</span> <span class=n>encoding</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;gzip&#39;</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>0</span>

        <span class=n>filename</span> <span class=o>=</span> <span class=n>uri</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;#&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;?&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>extension</span> <span class=o>=</span> <span class=n>filename</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

        <span class=n>tmp</span> <span class=o>=</span> <span class=n>NamedTemporaryFile</span><span class=p>(</span>
            <span class=n>suffix</span><span class=o>=</span><span class=s1>&#39;.&#39;</span><span class=o>+</span><span class=n>extension</span><span class=p>,</span>
            <span class=nb>dir</span><span class=o>=</span><span class=n>storeDir</span><span class=p>,</span>
            <span class=n>delete</span><span class=o>=</span><span class=bp>False</span>
        <span class=p>)</span>

        <span class=n>d</span> <span class=o>=</span> <span class=n>zlib</span><span class=o>.</span><span class=n>decompressobj</span><span class=p>(</span><span class=mi>16</span> <span class=o>+</span> <span class=n>zlib</span><span class=o>.</span><span class=n>MAX_WBITS</span><span class=p>)</span>
        <span class=k>while</span> <span class=bp>True</span><span class=p>:</span>
            <span class=n>data</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>READ_BLOCK_SIZE</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>data</span><span class=p>:</span>
                <span class=k>break</span>

            <span class=k>if</span> <span class=n>isGZipped</span><span class=p>:</span>
                <span class=n>data</span> <span class=o>=</span> <span class=n>d</span><span class=o>.</span><span class=n>decompress</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

            <span class=n>tmp</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>tmp</span><span class=o>.</span><span class=n>name</span>

    <span class=k>def</span> <span class=nf>_set_wallpaper</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filename</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Update gnome wallpaper&#34;&#34;&#34;</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=s2>&#34;Updating background to &#34;</span> <span class=o>+</span> <span class=n>filename</span><span class=p>)</span>
        <span class=n>call</span><span class=p>([</span>
            <span class=s2>&#34;gsettings&#34;</span><span class=p>,</span> <span class=s2>&#34;set&#34;</span><span class=p>,</span> <span class=s2>&#34;org.gnome.desktop.background&#34;</span><span class=p>,</span> <span class=s2>&#34;picture-uri&#34;</span><span class=p>,</span>
            <span class=s2>&#34;file://&#34;</span> <span class=o>+</span> <span class=n>filename</span>
        <span class=p>])</span>

    <span class=k>def</span> <span class=nf>_clean_dir</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>exclude</span><span class=p>):</span>
        <span class=s2>&#34;&#34;&#34;Remove all but excluded contents in given path&#34;&#34;&#34;</span>

        <span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>filenames</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
            <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
                <span class=n>fullpath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>fullpath</span> <span class=ow>in</span> <span class=n>exclude</span><span class=p>:</span>
                    <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>fullpath</span><span class=p>)</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
        <span class=n>rssUrl</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>

    <span class=n>wu</span> <span class=o>=</span> <span class=n>WallpaperUpdater</span><span class=p>(</span><span class=n>quiet</span><span class=p>)</span>
    <span class=n>wu</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>rssUrl</span><span class=p>,</span> <span class=n>tempPath</span><span class=p>,</span> <span class=n>keepFiles</span><span class=p>)</span></code></pre></div><h4>Usage</h4><code>python /path/to/grwu.py [url]</code><p>If no URL is given it defaults to NASA image of the day feed, which honestly is probably the only one giving supported format RSS. I checked a few other "picture of the day" RSS feeds and they seem to be quite random in how they provide the links to the images, and didn't bother supporting them.</p><p>Recommended usage is that you add a line in your crontab (run "crontab -e" to edit it) to periodically update your wallpaper, e.g. to update it every 30 minutes add:</p><code>30 * * * * export $(xargs -n 1 -0 echo &lt;/proc/$(pidof gnome-session)/environ | grep -Z DBUS_SESSION_BUS_ADDRESS=); python /path/to/grwu.py [url]</code><p>That horrible export command at the front is needed because the idiots behind the linux desktop development came up with DBUS and are now using it for everything. It pulls the DBUS session address for your running gnome session out of the environment of the running process and exports it to the cron environment before running the script.</p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://ublogger.netlify.app/?utm_source=https://lietu.net/&utm_medium=footer&utm_campaign=config&utm_term=2.0.1" target=_blank title="uBlogger 2.0.1">uBlogger</a></div><div class=footer-line><i class="svg-icon icon-copyright"></i><span>2021</span></div></div></footer></div><aside id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="svg-icon icon-arrow-up"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="svg-icon icon-comments-fixed"></i></a></aside><script src=/lib/smooth-scroll/smooth-scroll.min.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{}}</script><script src=/js/theme.min.js></script></body></html>